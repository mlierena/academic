# Perceptron

* 딥러닝의 기원이 되는 알고리즘
* **다수의 신호를 입력으로 받아 하나의 신호를 출력한다.**
* 출력신호의 값 y는 각 뉴런(노드)에서 보내는 `(입력신호 x) * (가중치 w)` 의 합이 `임계값(theta)`보다 크면 1(뉴런 활성화), 아니면 0이라는 값을 가지게 된다.
    * 여기서 퍼셉트론은 복수의 입력 신호 각각에 고유한 가중치를 부여하는데, 가중치는 "**각 신호가 결과에 주는 영향력을 조절하는 요소**" 로서 작용한다.
    * 가중치가 클 수록 해당 신호가 그만큼 더 중요하다.

## Perceptron 으로 논리회로 구현하기

* 입력 신호/출력 신호의 대응표를 작성해보는 게 첫번째 단계
* 가중치, 임계값으로 이루어진 매개변수 조합을 적당히 조절하면 된다.
    * 예시1 : AND 게이트를 퍼셉트론으로 표현할 경우, (w1, w2, θ)의 값은 다음 중 어떤 값으로 정해도 무난하다.
    > (0.5, 0.5, 0.7), (0.5, 0.5, 0.8), (1.0, 1.0, 1.0)    

    * 예시2 : NAND 게이트를 퍼셉트론으로 표현할 경우, AND 게이트를 구현하는 매개변수의 부호를 모두 반전
    > (-0.5, -0.5, -0.7)

    * "**기계학습에서는 이 매개변수 값을 정하는 작업을 인간이 아닌 컴퓨터가 자동으로 하도록 해야한다.**"
        * `학습` : 적절한 매개변수의 값을 정하는 작업
        * 사람은 퍼셉트론의 모델을 고민하고, 컴퓨터에 학습할 데이터를 주는 일을 한다.

### 논리회로를 이용한 간단한 구현

* AND 게이트 구현하기
```python
def AND(x1, x2):
    w1, w2, theta = 0.5, 0.5, 0.7
    tmp = x1*w1 + x2*w2
    if tmp <= theta:
        return 0
    elif tmp > theta:
        return 1
```

* `편향(bias)` : 임계값 θ의 부호를 반전시킨 값. 뉴런이 얼마나 쉽게 활성화하느냐를 조정하는 매개변수
    * 퍼셉트론을 달리 표현하면, `입력신호 * 가중치`와 편향의 합이 0을 넘으면 1을 출력하고, 그렇지 않으면 0을 출력하게 된다고 할 수 있다.
    * 편향이 0에 가까울 수록, 뉴런이 쉽게 활성화한다. (단, `입력신호 * 가중치`의 합이 편향의 값과 부호가 반대여야 함)

#### 가중치와 편향을 도입한 AND 게이트 구현

```python
def AND(x1, x2):
    x = np.array([x1, x2])
    w = np.array([0.5, 0.5])
    b = -0.7
    tmp = np.sum(w*x) + b 
    if tmp <= 0:
        return 0
    else:
        return 1

def NAND(x1, x2):
    x = np.array([x1, x2])
    w = np.array([-0.5, -0.5])
    b = 0.7
    tmp = np.sum(w*x) + b 
    if tmp <= 0:
        return 0
    else:
        return 1

def OR(x1, x2):
    x = np.array([x1, x2])
    w = np.array([0.5, 0.5])
    b = -0.2
    tmp = np.sum(w*x) + b 
    if tmp <= 0:
        return 0
    else:
        return 1
```

> AND, NAND, OR는 모두 같은 구조의 퍼셉트론일 뿐, 가중치 매개변수의 값만 차이날 뿐이다!

### 퍼셉트론의 한계

단층 퍼셉트론(single-layer perceptron)은 직선 하나로 나눈 영역만 표현할 수 있다는 한계가 있다.
직선으로 영역을 나누기 어려울 경우, 곡선으로 영역을 나누는게 불가피함
* `선형` 영역 : 직선으로 나누어지는 영역 
* `비선형` 영역 : 어쩔 수 없이 곡선으로 나누어지는 영역

#### 다층퍼셉트론을 이용한 XOR 게이트 구현

다층 퍼셉트론(multy-layer perceptron) : 여러층으로 구성된 퍼셉트론

```python
def XOR(x1, x2):
    s1 = NAND(x1,x2)
    s2 = OR(x1,x2)
    y = AND(s1,s2)
    return y
```

> 단층 퍼셉트론을 표현하지 못하는 것들은 층을 더 늘려서 구현할 수 있다. 퍼셉트론은 층을 쌓아 더 다양한 것을 표현할 수 있다.

## 교훈

논리 게이트를 퍼셉트론으로 구현 가능하다 -> 좀 더 복잡한 회로(반가산기, 전가산기, ALU, CPU)도 퍼셉트론으로 만들 수 있다. -> " **컴퓨터도 퍼셉트론으로 표현할 수 있다.** "
* [Coursera "NAND에서 테트리스까지"](https://www.coursera.org/learn/build-a-computer) 참고
